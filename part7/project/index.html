<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
<script src="https://d3js.org/d3.v4.min.js"></script>
    <style>
    </style>
    <script type="text/javascript">
    	function draw(data) {
	        "use strict";
	        var margin = 75,
	            width = 1400 - margin,
	            height = 600 - margin;

	        var svg = d3.select("body")
	            .append("svg")
	            .attr("width", width + margin)
	            .attr("height", height + margin)
	            .append('g')
	            .attr('class', 'chart');

            svg.selectAll("circle")
            .data(data)
            .enter()
            .append("circle");


	        var month_extent = d3.extent(data, function(d) {
	        	return d['Month'];
	        });

	        var dayOfWeek_extent = d3.extent(data, function(d) {
	        	return d['DayOfWeek'];
	        });

	        var meanDelay_extent = d3.extent(data, function(d) {
	        	return d['meanDelay'];
	        });

          var xMin = d3.min(data, function(d) {
            return d['depInterval'];
          });

          var xMax = d3.max(data, function(d) {
            return d['depInterval'];
          });

          var depInterval_scale = d3.scaleTime()
          .range([margin, width])
          .domain([xMin, xMax]);

			var meanDelay_scale = d3.scaleLinear()
            	.range([height, margin])
            	.domain(meanDelay_extent);

			var time_axis = d3.axisBottom(depInterval_scale)
        .ticks(24)
        .tickFormat(d3.timeFormat("%H:%M"));

			var delay_axis = d3.axisLeft(meanDelay_scale);

			svg.append('g')
			.attr('class', 'x axis')
			.attr('transform', "translate(0," + height + ")")
			.call(time_axis);

			svg.append('g')
			.attr('class', 'y axis')
			.attr('transform', "translate(" + margin + ",0)")
			.call(delay_axis);

			svg.selectAll("circle")
				.attr('cx', function(d) {

          return depInterval_scale(d['depInterval']);
				})
				.attr('cy', function(d) {
          // debugger;
					return meanDelay_scale(d['meanDelay']);
				})
				.attr('r', 5)
				.attr('fill', 'black');
    	}
    </script>
  </head>
<body>
  <script type="text/javascript">
  	var parseHour = d3.timeParse("%H:%M");

    d3.csv("2008-mean.csv", function(d) {
      d['depInterval'] = parseHour(d['depInterval']);
      d['meanDelay'] = +d['meanDelay'];

      return d;
    }, draw);
  </script>
</body>
</html>
