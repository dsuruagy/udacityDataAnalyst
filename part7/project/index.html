<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
<script src="https://d3js.org/d3.v4.min.js"></script>
    <style>
    </style>
    <script type="text/javascript">
    	function draw(data) {
	        "use strict";
	        var margin = 75,
	            width = 1400 - margin,
	            height = 600 - margin;

	        var svg = d3.select("body")
	            .append("svg")
	            .attr("width", width + margin)
	            .attr("height", height + margin)
	            .append('g')
<<<<<<< HEAD
	            .attr('class', 'chart');

	        var meanDelay_extent = d3.extent(data, function(d) {
	        	return d['meanDelay'];
	        });

          // https://stackoverflow.com/questions/23558701/d3-js-line-chart-with-time-on-both-axis
          var xMin = d3.min(data, function(d) {
            return d['depInterval'];
          });

          var xMax = d3.max(data, function(d) {
            return d['depInterval'];
          });

          var scaleInterval = d3.scaleTime()
          .range([margin, width])
          .domain([xMin, xMax]);

    			var scaleDelay = d3.scaleLinear()
                	.range([height, margin])
                	.domain(meanDelay_extent);

    			var timeAxis = d3.axisBottom(scaleInterval)
            .ticks(24)
            .tickFormat(d3.timeFormat("%H:%M"));

    			var delayAxis = d3.axisLeft(scaleDelay);

    			svg.append('g')
    			.attr('class', 'x axis')
    			.attr('transform', "translate(0," + height + ")")
    			.call(timeAxis);

    			svg.append('g')
    			.attr('class', 'y axis')
    			.attr('transform', "translate(" + margin + ",0)")
    			.call(delayAxis);


          var nested = d3.nest()
                      .key(function(d) { return d['Month']})
                      .key(function(d) { return d['depInterval']})
                      .rollup(function(leaves) {
                        return d3.sum(leaves, function(d) { return d['meanDelay']});
                      })
                      .entries(data);

          svg.selectAll("circle")
          .data(nested[1]['values'])
          .enter()
          .append("circle")
    				.attr('cx', function(d) {
              // debugger;

              return scaleInterval(d3.isoParse(d['key']));
    				})
    				.attr('cy', function(d) {
              // debugger;
    					return scaleDelay(d['value']);
    				})
    				.attr('r', 5)
    				.attr('fill', 'black');
     }
=======
	            .attr('class', 'chart');    		

            svg.selectAll("circle")
            .data(data)
            .enter()
            .append("circle");

	        debugger;

	        var month_extent = d3.extent(data, function(d) {
	        	return d['Month'];
	        });

	        var dayOfWeek_extent = d3.extent(data, function(d) {
	        	return d['DayOfWeek'];
	        });

	        var depInterval = ['0:00', '1:00', '2:00', '3:00', '4:00', '5:00', '6:00',
	        	'7:00','8:00','9:00','10:00','11:00','12:00','13:00', '14:00', '15:00', '16:00',
	        	'17:00','18:00','19:00','20:00','21:00','22:00','23:00'];

	        var meanDelay_extent = d3.extent(data, function(d) {
	        	return d['meanDelay'];
	        });

	        var depInterval_scale = d3.scale.ordinal()
            	.range([margin, width])
            	.domain(depInterval);

			var meanDelay_scale = d3.scale.linear()
            	.range([height, margin])
            	.domain(meanDelay_extent);

			var time_axis = d3.svg.axis()
			.scale(depInterval_scale);
			// .ticks(d3.time.hour, 1);

			var delay_axis = d3.svg.axis()
			.scale(meanDelay_scale)
			.orient("left");

			svg.append('g')
			.attr('class', 'x axis')
			.attr('transform', "translate(0," + height + ")")
			.call(time_axis);

			svg.append('g')
			.attr('class', 'y axis')
			.attr('transform', "translate(" + margin + ",0)")
			.call(delay_axis);

			svg.selectAll("circle")
				.attr('cx', function(d) {
					return d['depInterval'];
				})
				.attr('cy', function(d) {
					return d['meanDelay'];
				})
				.attr('r', 5)
				.attr('fill', 'black');
    	}
>>>>>>> 63b4394297f28dc9f84d8a949f2db53f9b495352
    </script>
  </head>
<body>
  <script type="text/javascript">
<<<<<<< HEAD
  	var parseHour = d3.timeParse("%H:%M");

    d3.csv("2008-mean.csv", function(d) {
      d['depInterval'] = parseHour(d['depInterval']);
      d['meanDelay'] = +d['meanDelay'];

      return d;
    }, draw);
=======
   
	d3.csv("2008-mean.csv", function(d) {
		d['date'] = d['Year'] + '/' + d['Month'] + '/' + d['Dayof'];
		return d;
	}, draw);
>>>>>>> 63b4394297f28dc9f84d8a949f2db53f9b495352
  </script>
</body>
</html>
