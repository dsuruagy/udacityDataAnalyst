Prosper Loan by Daniel R. S. Monteiro
========================================================

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Load all packages
library(ggplot2)
library(gridExtra)
#library(GGally)
#library(PerformanceAnalytics)
library(corrr)
library(corrplot)
```

```{r echo=FALSE, message=FALSE, warning=FALSE, Load_the_Data}
# Load the Data
setwd('/home/daniel/dataAnalyst/part5/project')
wine_quality <- read.csv('wineQualityWhites.csv')
```

In this document, I will investigate some data from white wines produced by 
"Vinho Verde", a portuguese wine producer. These data were collected as part of
a study conducted on University of Minho, at 2009. 

There are 11 input variables, with chemical characteristics of these wines, and 1 
output variable that indicates a wine expert evaluation of the quality of the samples.



# Univariate Plots Section

Lets take a look on the variables and some of the values.

```{r echo=FALSE, Univariate_visualization}
str(wine_quality)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
qplot(fixed.acidity, data=wine_quality)

summary(wine_quality$fixed.acidity)
```
Fixed acidity is composed for the tartaric acid, which is the primary acid 
component in grapes
(http://www.calwineries.com/learn/wine-chemistry/wine-acids/tartaric-acid), and
influences the total acidity of wines. 

Some values could be used as reference for white wines (http://winemaking.jackkeller.net/acid.asp)
Dry White Grape Wines..........0.65-0.75% (6.5 - 7.5 g/L)
Sweet White Grape Wines.......0.70-0.85% (7.0 - 8.5 g/L)

The median falls on dry white grape wines, which can be the prime wine produced.

```{r echo=FALSE, message=FALSE, warning=FALSE}
qplot(volatile.acidity, data=wine_quality)

summary(wine_quality$volatile.acidity)
```

(acetic acid - g / dm^3)
. at too high of levels can lead to an unpleasant, vinegar taste.
. A taster's sensitivity to acetic acid will vary, but most people can detect excessive amounts at around 600 mg/l (J. Robinson (ed) “The Oxford Companion to Wine” Third Edition pg 2–3 Oxford University Press 2006 ISBN 0-19-860990-6). with concentrations greater than 1.2-1.3 g/L becoming unpleasant.
. A wine with too much acidity will taste excessively sour and sharp. A wine with too little acidity will taste flabby and flat, with less defined flavors.(same as above)

**** What I expect: wines with VA > 0.6 g/L will be low evaluated.

```{r echo=FALSE, message=FALSE, warning=FALSE}
qplot(citric.acid, data=wine_quality)

summary(wine_quality$citric.acid)
```

found in small quantities, citric acid can add 'freshness' and flavor to wines


```{r echo=FALSE, message=FALSE, warning=FALSE}
qplot(residual.sugar, data=wine_quality)

ggplot(wine_quality, aes(x=residual.sugar)) +
  geom_histogram() +
  scale_x_log10(breaks=c(5, 10, 20, 30)) 

# Breaks of residual sugar were obtained on 
# https://vinepair.com/wine-blog/cheat-sheet-white-wine-sweetness-chart-guide/
#wine_quality$sweetness <- cut(wine_quality$residual.sugar, 
#                              breaks = c(0, 5, 10, 20, 30, 100),
#                              labels = c('Extra dry', 'Dry', 'Semi Dry',
#                                         'Semi Sweet', 'Sweet'))
#table(wine_quality$sweetness)
```

. Classification of sugar in wine: http://winefolly.com/review/sugar-in-wine-chart/
. sugar to acid ration: http://drinkriesling.com/tasteprofile/thescale

By the classification found on 
https://vinepair.com/wine-blog/cheat-sheet-white-wine-sweetness-chart-guide/, 
dry wine is the majority produced.

```{r echo=FALSE, message=FALSE, warning=FALSE}
qplot(chlorides, data=wine_quality)

summary(wine_quality$chlorides)
```



```{r echo=FALSE, message=FALSE, warning=FALSE}
qplot(total.sulfur.dioxide, data=wine_quality)

#summary(wine_quality$total.sulfur.dioxide)
```
.In most cases compounds such as sulfur dioxide or erythorbic acid are added to wine by winemakers, which protect the wine from oxidation and also bind with some of the oxidation products to reduce their organoleptic effect.[4]

```{r echo=FALSE, message=FALSE, warning=FALSE}
qplot(pH, data=wine_quality)

summary(wine_quality$pH)
```

Like describe in http://winefolly.com/review/understanding-acidity-in-wine/, 
a pH of 3 is caracteristic for a sweet white, while 3.1 is for light-bodied 
white wines. The median is very near these values.


```{r echo=FALSE, message=FALSE, warning=FALSE, Univariate_Plots}
ggplot(wine_quality, aes(x=quality)) +
  geom_bar()

summary(wine_quality$quality)
```

To finish, I was looking forward to see how the experts had qualified the wine. 
It is possible to identify that no wine has received the minimum or the maximum 
grade. The grades distribution is normal, with a median of 6.

I wonder why most of wines received a grade of 5 or 6. What chemical 
characteristics could explain these grades?

# Univariate Analysis

### What is the structure of your dataset?

This dataset contains 4,898 observations, well structured on tidy data, with 12
variables. Some characteristics of this dataset:

. Most wines are graded with 6.
. Most of them are extra dry or dry, accordingly with classification of
residual sugar.
. Fixed and volatile acidity and pH are inside what could be expected for white
wines.

ORIGINAL DESCRIPTION:
This tidy data set contains 4,898 white wines with 11 variables on quantifying the chemical properties of each wine. At least 3 wine experts rated the quality of each wine, providing a rating between 0 (very bad) and 10 (very excellent).

### What is/are the main feature(s) of interest in your dataset?

I think the main features are fixed.acidity, residual.sugar, pH
and quality.

### What other features in the dataset do you think will help support your \ 
investigation into your feature(s) of interest?

Others that could be of interest are volatile.acidity, chlorides and total.sulfur.dioxide.

### Did you create any new variables from existing variables in the dataset?

Yes, like wine sweetness classification, based on residual sugar.

### Of the features you investigated, were there any unusual distributions? \
Did you perform any operations on the data to tidy, adjust, or change the form \
of the data? If so, why did you do this?

Residual sugar plot could be more easily seen when applying a log 10 transformation, which reveals a bimodal distribution.

# Bivariate Plots Section

> **Tip**: Based on what you saw in the univariate plots, what relationships
between variables might be interesting to look at in this section? Don't limit
yourself to relationships between a main output feature and one of the
supporting variables. Try to look at relationships between supporting variables
as well.

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Used for reference: http://jamesmarquezportfolio.com/correlation_matrices_in_r.html

# PerformanceAnalytics:
#chart.Correlation(wine_quality[, 1:13], histogram=TRUE, pch=19)
network_plot(correlate(wine_quality), min_cor=0.2, legend = TRUE)

corrplot.mixed(cor(wine_quality), order="hclust", tl.col="black")

```


```{r echo=FALSE, message=FALSE, warning=FALSE, Bivariate_Plots_density}
p_sugar <- ggplot(wine_quality, aes(x=residual.sugar, y=density)) +
  geom_point(alpha=0.1) 

p_alcohol <- ggplot(wine_quality, aes(x=alcohol, y=density)) +
  geom_point(alpha=0.1) + ylab(NULL) +
  scale_y_continuous(labels = NULL)

p_sulfur <- ggplot(wine_quality, aes(x=total.sulfur.dioxide, y=density)) +
  geom_point(alpha=0.1) + ylab(NULL) +
  scale_y_continuous(labels = NULL)

grid.arrange(p_sugar, p_alcohol, p_sulfur, ncol=3)
```

The stronger relationships between variables involves density.

The first of them is found on density per residual sugar. Is it possible to 
perceive a positive correlation, which corresponds to 0.84.

Next stronger correlation is density per alcohol, with a value of negative 0.76.

Finally, total.sulfur.dioxide has a positive correlation with density, with a value of positive 0.62.

```{r echo=FALSE, message=FALSE, warning=FALSE, Bivariate_Plots_alcohol}
p_alc_sulfur <- ggplot(wine_quality, aes(x=alcohol, y=total.sulfur.dioxide)) +
  geom_jitter(alpha=0.1) + xlab(NULL)  +
  scale_x_continuous(labels = NULL) +
  geom_smooth(method='lm')

p_alc_sugar <- ggplot(wine_quality, aes(x=alcohol, y=residual.sugar)) +
  geom_jitter(alpha=0.1) + xlab(NULL) +
  scale_x_continuous(labels = NULL) +
  geom_smooth(method='lm')

p_alc_chloride <- ggplot(wine_quality, aes(x=alcohol, y=chlorides)) +
  geom_jitter(alpha=0.1) +
  geom_smooth(method='lm')

grid.arrange(p_alc_sulfur, p_alc_sugar, p_alc_chloride, ncol=1)
```

These relationships are related to alcohol. Here, when increasing its quantity,
reflects on lowering total.sulfur.dioxide, residual.sugar and chlorides, 
respectively.

```{r echo=FALSE, message=FALSE, warning=FALSE, Bivariate_Plots_pH}
#pH x fixed.acidity
ggplot(wine_quality, aes(x=fixed.acidity, y=pH)) +
  geom_jitter(alpha=0.3)
```

It is known that lower values of pH indicates more acidity, and it is what can
be seen when comparing pH per fixed.acidity, with a negative correlation.

```{r echo=FALSE, message=FALSE, warning=FALSE}
wine_quality$quality <- factor(wine_quality$quality)

ggplot(wine_quality, aes(x=quality, y=volatile.acidity)) +
  geom_boxplot() + 
  coord_cartesian(ylim=c(0.15, 0.5))

ggplot(wine_quality, aes(x=quality, y=chlorides)) +
  geom_boxplot() + 
  coord_cartesian(ylim=c(0.0, 0.1))

ggplot(wine_quality, aes(x=quality, y=density)) +
  geom_boxplot() + 
  coord_cartesian(ylim=c(0.985, 1.005))

ggplot(wine_quality, aes(x=quality, y=alcohol)) +
  geom_boxplot()

ggplot(wine_quality, aes(x=quality, y=alcohol)) +
  geom_violin()

by(wine_quality$alcohol, wine_quality$quality, summary)
```

Which variables could influence quality? Many of them, because wine quality can
be very subjective for the specialists. It depends on a combination of acidity,
sweetness, color, aroma and many other aspects. Here, I analyse the variables
that appear to be more correlated with quality: chloride, volatile acidity, 
density and alcohol.

It is important to note that these are weak correlations. Many values are present
in all quality grades and it is necessary to analyse the frequency of values 
which appear more on the grades, but it is not garanteed to be meaningful.

I think the weakest of them is volatile acidity per quality, with a value of -0.19.
Median values for volatile acidity of wines that received quality grade 3 is not
so different to those that received grade 8 or 9.

A few better is the relationship between chlorides and quality (-0.21). Less
chlorides seems to correspond to better wine quality, but the differences are 
very small and it is not possible to see significant difference between the
quantities for quality 3 or 6, for example.

Except for quality grade 5, the relationship between density and quality seems to
be more clear. Higher grades were assigned for less dense wines.

Alcohol has the highest correlation with quality, with a value 0.44. As oposite to 
density, like seen in the plot of these relationships, the higher the alcohol 
median value, the higher the grade. These can be seen on the violin plot, which 
surprisingly present a cup of wine for the highest grade!

# Bivariate Analysis

> **Tip**: As before, summarize what you found in your bivariate explorations
here. Use the questions below to guide your discussion.

### Talk about some of the relationships you observed in this part of the \
investigation. How did the feature(s) of interest vary with other features in \
the dataset?

### Did you observe any interesting relationships between the other features \
(not the main feature(s) of interest)?

### What was the strongest relationship you found?


# Multivariate Plots Section

> **Tip**: Now it's time to put everything together. Based on what you found in
the bivariate plots section, create a few multivariate plots to investigate
more complex interactions between variables. Make sure that the plots that you
create here are justified by the plots you explored in the previous section. If
you plan on creating any mathematical models, this is the section where you
will do that.

#```{r echo=FALSE, Multivariate_Plots}

#```

# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. Were there features that strengthened each other in terms of \
looking at your feature(s) of interest?

### Were there any interesting or surprising interactions between features?

### OPTIONAL: Did you create any models with your dataset? Discuss the \
strengths and limitations of your model.

------

# Final Plots and Summary

> **Tip**: You've done a lot of exploration and have built up an understanding
of the structure of and relationships between the variables in your dataset.
Here, you will select three plots from all of your previous exploration to
present here as a summary of some of your most interesting findings. Make sure
that you have refined your selected plots for good titling, axis labels (with
units), and good aesthetic choices (e.g. color, transparency). After each plot,
make sure you justify why you chose each plot by describing what it shows.

### Plot One
#```{r echo=FALSE, Plot_One}

#```

### Description One


### Plot Two
#```{r echo=FALSE, Plot_Two}

#```

### Description Two


### Plot Three
#```{r echo=FALSE, Plot_Three}

#```

### Description Three

------

# Reflection

> **Tip**: Here's the final step! Reflect on the exploration you performed and
the insights you found. What were some of the struggles that you went through?
What went well? What was surprising? Make sure you include an insight into
future work that could be done with the dataset.

- struggle: how to find a better correlation matrix plot to find interesting
variables relationships. Tried some of them like GGally and PerformanceAnalytics
but the results were not good.

> **Tip**: Don't forget to remove this, and the other **Tip** sections before
saving your final work and knitting the final report!